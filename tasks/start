#!/bin/bash

# S33 workflow task
# It adds the actual work to do to the job's task list

#if s3 bucket proivided...
if [ -e ${JOBPATH}/bucket_file ]; then
  echo 'addtask:get-from-s3' >> "$JOBCONTROL"
fi

# If there are no rof files in the job directory...
if [ -z $(find "$JOBPATH" -maxdepth 1 -name 'metadata-*.rof' -print -quit) ]; then
  # no rof files, so process any csv files
  echo 'addtask:csv-to-rof' >> "$JOBCONTROL"
fi
echo 'addtask:work-xlat' >> "$JOBCONTROL"
echo 'addtask:assign-pids' >> "$JOBCONTROL"
echo 'addtask:file-to-url' >> "$JOBCONTROL"
echo 'addtask:date-stamp' >> "$JOBCONTROL"
echo 'addtask:validate' >> "$JOBCONTROL"
echo 'addtask:move-files-for-bendo' >> "$JOBCONTROL"
echo 'addtask:upload-to-bendo' >> "$JOBCONTROL"
echo 'addtask:ingest' >> "$JOBCONTROL"
echo 'addtask:index' >> "$JOBCONTROL"
echo 'addtask:characterize' >> "$JOBCONTROL"
